{"name":"notnullcheckweaver","tagline":"Dynamically enforces @NotNull annotations in Java programs through run-time bytecode instrumentation","body":"This project delivers a Java agent (i.e. a bytecode transformer that is executed on the fly by the JVM as it loads classes) that adds run-time checks that enforce `@NotNull` annotations on parameters, method results, and fields.\r\n\r\n# Motivation #\r\n\r\nThe programming style where the programmer inserts thorough validity checks of parameter values at the top of each method (or at least those that constitute the exported interface of the module) is a very beneficial one. It helps reduce the distance between the source location where an error manifests itself and where it originates. Also, it helps the explicit separation of responsibilities and blame assignment between the modules of the system.\r\n\r\nUnfortunately, due to the fact that every value of reference type in Java can be null, adhering to this style means inserting a large number of null checks throughout the program. For example:\r\n\r\n```java\r\npublic class MyClass {\r\n\r\n    /** Frobs the specified foo, bar, and baz.\r\n      *\r\n      * o1 and o2 should not be null.\r\n      */\r\n    public void frob(Foo o1, Bar o2, Baz o3) {\r\n        if (o1 == null) throw new IllegalArgumentException(\"o1 is null\");\r\n        if (o2 == null) throw new IllegalArgumentException(\"o2 is null\");\r\n        // do the actual frobbing\r\n    }\r\n\r\n}\r\n```\r\n\r\nBy using `notnullcheckweaver`, you can reduce this code to the following:\r\n\r\n```java\r\n@NotNull\r\npublic class MyClass {\r\n\r\n    /** Frobs the specified foo, bar, and baz. */\r\n    public void frob(Foo o1, Bar o2, @Nullable Baz o3) {\r\n        // do the actual frobbing\r\n    }\r\n\r\n}\r\n```\r\n\r\nBesides reducing boilerplate, this approach appropriately draws attention to nullable values, which deserve special attention, rather than the harmless not-null values.\r\n\r\nTo achieve this benefit, it would be sufficient if `notnullcheckweaver` checked just argument values. In fact, it checks also method results and field values. This yields the added benefit that also for these values one can assume, unless stated otherwise explicitly, that these values are never null.\r\n\r\n# Basic walkthrough #\r\n\r\nHere is an example program that uses `@NotNull`:\r\n\r\n```java\r\npackage mypackage;\r\n\r\nimport notnullcheckweaver.NotNull;\r\nimport notnullcheckweaver.ArgumentNotNullCheckException;\r\n\r\n@NotNull\r\npublic class MyProgram {\r\n\r\n    private static void foo(Object object) {}\r\n    \r\n    public static void main(String[] args) {\r\n        try {\r\n            foo(null);\r\n            System.out.println(\"It doesn't work :-(\");\r\n        } catch (ArgumentNotNullCheckException e) {\r\n            System.out.println(\"It works! :-)\");\r\n        }\r\n    }\r\n\r\n}\r\n```\r\n\r\nCompile this program as follows:\r\n\r\n```\r\njavac -classpath notnullcheckweaver.jar mypackage/MyProgram.java\r\n```\r\n\r\nRun it as follows:\r\n\r\n```\r\njava -javaagent:notnullcheckweaver.jar mypackage.MyProgram\r\n```\r\n\r\nYou should get the following output:\r\n\r\n```\r\nIt works! :-)\r\n```\r\n\r\n# Further info #\r\n\r\nA variable (parameter, method result, or field) is considered `@NotNull` either if it is marked as `@NotNull` directly, or if an enclosing element (class or package) is marked as `@NotNull` and no closer enclosing element is marked as `@Nullable`. For the purposes of this definition, package `foo` is considered to enclose package `foo.bar`.\r\n\r\nThe most convenient approach is to mark your toplevel package as `@NotNull`, and to put `@Nullable` on the individual parameters, method results, and fields for which `null` is a valid value.\r\n\r\nFor example:\r\n\r\n```java\r\n// mypackage/package-info.java\r\n\r\n@NotNull\r\npackage mypackage;\r\n\r\nimport notnullcheckweaver.NotNull;\r\n```\r\n\r\n```java\r\n// mypackage/mysubpackage/MyClass.java\r\n\r\npackage mypackage.mysubpackage;\r\n\r\nimport notnullcheckweaver.Nullable;\r\n\r\npublic class MyClass {\r\n\r\n    public static void myMethod(MyClass foo, @Nullable MyClass bar) {\r\n        // ...\r\n    }\r\n\r\n}\r\n```\r\n\r\nIn the above example, due to the `@NotNull` annotation on package `mypackage`, parameter `foo` of method `myMethod` is considered `@NotNull` and the weaver will insert a not-null check for this parameter at the top of the bytecode of `myMethod` when `MyClass` is loaded.\r\n\r\nSee also the documentation in the distribution, and the test cases in the source repository.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}